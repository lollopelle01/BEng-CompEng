package lorenzo_pellegrino_0000971455;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.net.Socket;

public class pellegrino_lorenzo_0000971455_Thread extends Thread{ 
	private int servizio; // (0, 1) = (conta_file, trasferisci_file)
	
	//conta_file
	private char carattere;
	private int occorrenze;
	
	//trasferisci_file
	private String direttorio=null;
	
	//Server
	private Socket threadSocket=null;
	
	//costruttori
	public pellegrino_lorenzo_0000971455_Thread(char c, int occ, Socket socket) {
		this.carattere = c;
		this.occorrenze = occ;
		this.threadSocket = socket;
		
		this.servizio = 0;
	}
	public pellegrino_lorenzo_0000971455_Thread(String dir, Socket socket) {
		this.direttorio = dir;
		this.threadSocket = socket;
		
		this.servizio = 1;
	}
	
	//codice
	public void run() {
		File folder=null;
		int count_linee, count_occ, i;
		String line = null;
		
		if(this.servizio == 0) { //conta_file
			try {
				folder = new File(".");
				BufferedReader br = null;
				count_linee=0;
				for(File entry : folder.listFiles()) {
					if(entry.getAbsolutePath().endsWith(".txt")) { //considero solo file.txt
						br = new BufferedReader(new FileReader(entry));
						while((line=br.readLine())!=null) {
							count_occ=0;
							for(i=0; i<line.length(); i++) {
								if(line.charAt(i)==this.carattere) {
									count_occ++;
								}
							}
							if(count_occ >= this.occorrenze) {
								count_linee++;
							}
						}
					}
				}
			}catch(Exception e) {
				
			}
		}
		
		if(this.servizio == 1) { //trasferisci_file
			try {
				folder = new File(this.direttorio);
				for(File entry : folder.listFiles()) {
					if(!entry.getAbsolutePath().endsWith(".txt")) { //considero solo file binari
						
					}
				}
			}catch(Exception e) {
				
			}
		}
	}
}
