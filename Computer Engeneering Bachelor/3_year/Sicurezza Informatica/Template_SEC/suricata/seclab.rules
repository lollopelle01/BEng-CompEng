########################################################################################
## TEMPLATE COMANDI ####################################################################                                                        
########################################################################################

# suricata -c /etc/suricata/suricata.yaml -r ~/Desktop/esame/FILE_PCAP
# cat eve.json | jq 'select(.event_type="alert")'
# echo "testocodificato" | base64 -d

########################################################################################
## TEMPLATE REGOLE #####################################################################
########################################################################################

## Regole esercitazione ###
# alert icmp any any -> any any (msg:"Ping detected"; itype:8; sid:1000477; rev:1;)
# alert tls any any -> any any (msg:"SURICATA TRAFFIC-ID: youtube"; tls_sni; content:"youtube.com"; isdataat:!1,relative; flow:to_server,established; flowbits: set,traffic/id/bing; flowbits:set,traffic/label/search; noalert; sid:300000000; rev:1;)
# alert tls any any -> any any (msg:"SURICATA TRAFFIC-ID: facebook"; tls_sni; content:"facebook.com"; isdataat:!1,relative; flow:to_server,established; flowbits: set,traffic/id/facebook; flowbits:set,traffic/label/social-network; sid:300000001; rev:1;)
# alert http any any -> any any (msg:"Volex – Possible CVE-2014-6271 bash Vulnerability Requested (header)"; flow:established,to_server; content:"() {"; http_header; threshold:type limit, track by_src, count 1, seconds 120; sid:2014092401;

## Regole esame_20220715 ###
# alert tcp 192.168.56.1 40144 <> 192.168.56.8 5001 (msg:"Trovato"; sid:300000001; rev:1;) 
