ESERCIZIO SURICATA 10/02/2023

--CONSEGNA

1) Scrivere una regola suricata in modalità alert per TUTTO il traffico icmp SOLTANTO IN ENTRATA sulla rete 192.168.X.X

Hint. ( Se pensate sia necessario cambiare la configurazione di suricata è bene specificarlo inserendo le righe
da modificare )

2) Scrivere una (o più) regola suricata in modalità alert per qualsiasi richiesta a evilcorp.com. Nota bene NON è possibile utilizzare il protocollo http o la porta 80 per creare questa regola.


3) È stato rilasciato un file pcap esame_10_febbraio_2023.pcapng
Il file rappresenta il tracciato di traffico di diversi tentativi di autenticazione su di un noto protocollo. Compito dello studente è identificare:
-- Protocollo del traffico
-- I 2 Indirizzi Ip in gioco (considerate che ovviamente il traffico è in due direzioni)
-- La/Le porte del protocollo in gioco
Hint: Avete un tool valido per recuperare queste informazioni

--RISOLUZIONE

1) Andare a modificare il file di configurazione di security.yaml -> il traffico in entrata è definitio da HOME_NET, quindi basta commentare il primo e non commentare il secondo che è quello che serve a noi
    alert tcmp any any -> $HOME_NET any (msg:"Ping detected: ICMP"; sid: 300000006; rev:1;)

2) alert dns any any -> any any (msg:"DNS request evilcorp.com";dns_query; content:"evilcorp.com" sid:300000007; rev:1;)

   alert ip any any -> 137.204.24.23 any(msg:"Request evilcorp.com"; sid:300000008; rev:1;)

3) --protocollo del traffico: TLNET
   --2 indirizzi IP in gioco: 192.168.56.1 192.168.56.8
   --le porte del protocollo in gioco: porta 23 (porta di Telnet)

   alert tcp 192.168.56.1 23 -> 192.168.56.8 48130 (msg:"Found Flag", flow:from_client; flowbits:set, logged_in; content"sec:sec"; sid:100005; rev:1;)
