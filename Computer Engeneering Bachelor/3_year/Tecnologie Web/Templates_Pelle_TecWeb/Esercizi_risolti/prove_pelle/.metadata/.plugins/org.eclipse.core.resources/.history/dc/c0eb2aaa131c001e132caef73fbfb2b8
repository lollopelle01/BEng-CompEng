package it.unibo.tw.web.servlets;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.google.gson.Gson;

public class Servlet extends HttpServlet{
	private static final long serialVersionUID = -3403693893991634090L;
	Random random;
	Gson gson;
    BufferedReader br;

	@Override
	public void init() throws ServletException {
		this.random = new Random(System.currentTimeMillis());
		this.gson = new Gson();
		super.init();
	}
	
	@Override
	protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        
    }

    @Override
	protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        int flag = Integer.parseInt(req.getParameter("flag"));

        if(flag == 1){ // Richiesta esplicita
            
        }
        else{ // Richiesta implicita

        }

        // Faccio long-polling
        wait(120);

        // Invio notizie
        try {
            String content = new String(Files.readAllBytes(Path.of("database.txt")));
            
            System.out.println("Contenuto del file:");
            System.out.println(content);
        } catch (IOException e) {
            System.out.println("Si Ã¨ verificato un errore durante la lettura del file: " + e.getMessage());
        }
        res.

    }
}