package it.unibo.paw.dao;


import java.sql.Date;
import java.util.Calendar;
import java.util.List;

public class DAOTest {
	
	public static final int DAO = DAOFactory.DB2;
	
	public static void main(String[] args) {
		
		// Creo istanza DAO
		DAOFactory daoFactoryInstance = DAOFactory.getDAOFactory(DAO);
		
		// Creo database
		StadioDAO sDAO = daoFactoryInstance.getStadioDAO();
		sDAO.dropTable();
		sDAO.createTable();
		
		// Creo i DTO e li inserico
		StadioDTO s = new StadioDTO();
		s.setId(1);
		s.setCodice("Codice 1");
		s.setNome("Stadio 1");
		s.setCitta("Citta 1");
		sDAO.create(s);

		StadioDTO s1 = new StadioDTO();
		s1.setId(2);
		s1.setCodice("Codice 2");
		s1.setNome("Stadio 2");
		s1.setCitta("Citta 2");
		sDAO.create(s1);
		
		// Creo altro Database
		PartitaDAO pDAO = daoFactoryInstance.getPartitaDAO();
		pDAO.dropTable();
		pDAO.createTable();
		
		// Creo altri DTO e li inserisco
		PartitaDTO p = new PartitaDTO();
		p.setId(1);
		p.setCodicePartita("Codice 1");
		p.setCategoria("Calcio");
		p.setGirone("Girone 1");
		p.setNomeSquadraCasa("Juve");
		p.setNomeSquadraOspite("Bolo");
		p.setData(new Date(74278274));
		pDAO.create(p);

		course = new CourseDTO();
		course.setId(2);
		course.setName("Fondamenti di Informatica T1");
		courseDAO.create(course);
				
		
		// Creo altro database (mapping)
		CourseStudentMappingDAO mappingDAO = daoFactoryInstance.getStudentCourseMappingDAO();
		mappingDAO.dropTable();
		mappingDAO.createTable();

		// Compilo tabella
		mappingDAO.create(1, 1);
		mappingDAO.create(1, 2);
		mappingDAO.create(2, 2);
		
		// Faccio richieste ed analizzo i risultati
		StudentDTO student = studentDAO.read(1);
		System.out.println(student.getFirstName()+" "+student.getLastName()+" frequenta i seguenti corsi:");
		List<CourseDTO> corsiDiStudent = student.getCourses();
		for(CourseDTO cds : corsiDiStudent)
		{
			System.out.println(""+cds.getId()+" "+cds.getName());
		}
		System.out.println();
		
		CourseDTO paw = courseDAO.read(1);
		System.out.println("Il corso "+paw.getName()+" ï¿½ frequentato da:");
		List<StudentDTO> sdc = paw.getStudents();
		for(StudentDTO stu : sdc){
			
			System.out.println(""+stu.getFirstName()+" "+stu.getLastName()+" "+stu.getBirthDate());;
		}
		System.out.println();
		System.out.println();
	}

}
